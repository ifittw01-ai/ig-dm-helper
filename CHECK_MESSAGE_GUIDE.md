# 📬 检查用户消息设置 - 使用指南

## 🎯 功能说明

在群发时，程序会：
1. ✅ **在浏览器中打开用户的 Instagram 主页**
2. ✅ **提示您检查该用户是否有【訊息】按钮**
3. ✅ **根据您的确认决定是否发送**

---

## 📸 如何判断用户是否接受消息

### ✅ 可以发送消息的用户

在用户主页面会看到：

```
┌─────────────────────────────┐
│  用户名                      │
│  追蹤 (Follow)               │
│  訊息 (Message) ← 有这个按钮！│
│  ...                        │
└─────────────────────────────┘
```

**特征：**
- ✅ 有【訊息】或【Message】按钮
- ✅ 有【追蹤】或【Follow】按钮旁边有訊息按钮

---

### ❌ 不接受消息的用户

在用户主页面只会看到：

```
┌─────────────────────────────┐
│  用户名                      │
│  追蹤 (Follow)               │
│  (没有訊息按钮)              │
│  ...                        │
└─────────────────────────────┘
```

**特征：**
- ❌ 没有【訊息】或【Message】按钮
- ❌ 只有【追蹤】或【Follow】按钮
- ⚠️ 用户设置了消息隐私为"不接受陌生人消息"

---

## 🎮 使用流程

### 步骤 1：启动程序

```bash
run.bat
```

或

```bash
node demo-smart-batch-dm.js
```

### 步骤 2：程序打开浏览器

当程序运行到某个用户时：

```
[1/10] 目标用户: @username

🌐 正在浏览器中打开: https://www.instagram.com/username/

(浏览器自动打开该用户的主页)
```

### 步骤 3：查看用户主页

在浏览器中：

1. 👀 **查看用户的个人主页**
2. 🔍 **寻找【訊息】或【Message】按钮**
3. ✅ **有按钮 = 可以发送**
4. ❌ **没按钮 = 不能发送**

### 步骤 4：在终端确认

终端会显示：

```
╔══════════════════════════════════════════════════════════╗
║                    用户资料                              ║
╚══════════════════════════════════════════════════════════╝

👤 用户名: @username
👥 粉丝: 50.5K
...

────────────────────────────────────────────────────────────

📌 重要提示：
   请在浏览器中查看该用户的主页面
   检查是否有【訊息】或【Message】按钮

   ✅ 有訊息按钮 → 输入 y 发送
   ❌ 没有訊息按钮 → 输入 n 跳过

该用户是否可以接收消息？(y=可以/n=不可以/s=跳过/q=停止): 
```

### 步骤 5：输入选择

| 输入 | 说明 | 效果 |
|------|------|------|
| `y` | 可以接收消息 | ✅ 发送消息 |
| `n` | 不接受消息 | ❌ 自动跳过 |
| `s` | 跳过该用户 | ⏭️ 跳过 |
| `q` | 停止所有发送 | 🛑 停止 |

---

## 💡 判断技巧

### 快速判断方法

```
打开用户主页后，快速查看：

1️⃣ 头像下方的按钮：
   ✅ 追蹤 | 訊息  ← 有訊息按钮
   ❌ 追蹤        ← 没有訊息按钮

2️⃣ 如果不确定：
   尝试点击用户头像旁边的区域
   如果没有訊息按钮出现 = 不接受消息
```

---

## 📋 常见情况

### 情况 1：公开账号 + 接受消息

```
浏览器显示：
- 公开账号标志 🔓
- 有【訊息】按钮

操作：输入 y（发送）
```

### 情况 2：公开账号 + 不接受消息

```
浏览器显示：
- 公开账号标志 🔓
- 没有【訊息】按钮

操作：输入 n（跳过）
```

### 情况 3：私密账号 + 已关注

```
浏览器显示：
- 私密账号标志 🔒
- 已关注
- 有【訊息】按钮

操作：输入 y（发送）
```

### 情况 4：私密账号 + 未关注

```
浏览器显示：
- 私密账号标志 🔒
- 未关注
- 没有【訊息】按钮

操作：输入 n（跳过）
```

---

## 🎯 完整示例

### 示例 1：可以发送的用户

```bash
$ run.bat

[1/5] 目标用户: @bbo_musae.duck

🌐 正在浏览器中打开: https://www.instagram.com/bbo_musae.duck/

(浏览器显示)
头像：🦆
用户名：bbo_musae.duck
按钮：[追蹤] [訊息] ← 有訊息按钮！

(终端显示)
╔════════════════════════════════╗
║        用户资料                ║
╚════════════════════════════════╝

👤 用户名: @bbo_musae.duck
👥 粉丝: 19
📷 帖子: 8
🔓 公开账号

📌 重要提示：
   请在浏览器中查看该用户的主页面
   检查是否有【訊息】或【Message】按钮

   ✅ 有訊息按钮 → 输入 y 发送
   ❌ 没有訊息按钮 → 输入 n 跳过

该用户是否可以接收消息？(y=可以/n=不可以/s=跳过/q=停止): y

✅ 该用户可以接收消息，准备发送...

✅ 成功发送给 @bbo_musae.duck
```

### 示例 2：不接受消息的用户

```bash
[2/5] 目标用户: @someone

🌐 正在浏览器中打开: https://www.instagram.com/someone/

(浏览器显示)
用户名：someone
按钮：[追蹤] ← 只有追蹤按钮，没有訊息！

(终端显示)
该用户是否可以接收消息？(y=可以/n=不可以/s=跳过/q=停止): n

❌ 该用户不接受消息，自动跳过...

⏭️  已跳过 @someone
```

---

## 🔧 自动错误检测

如果您输入 `y` 但用户实际上不接受消息，程序会自动检测：

```
✅ 该用户可以接收消息，准备发送...

(尝试发送...)

══════════════════════════════════════════
🚫 用户不接受消息
══════════════════════════════════════════

目标用户: @username
错误信息: Cannot send message to this user

该用户已屏蔽您、不接受消息、或消息设置不开放。

已自动跳过该用户。
💡 提示：发送前请在浏览器中检查用户主页是否有【訊息】按钮。

══════════════════════════════════════════

⏭️  已跳过 @username
```

---

## 📊 最终报告

发送完成后：

```
════════════════════════════════════════
📊 发送报告
════════════════════════════════════════

总计: 10 个用户
✅ 成功: 5 个
❌ 失败: 0 个
⏭️  跳过: 5 个

跳过的用户:
  ⏭️  @user1 (user_manually_skipped) ← 手动跳过
  ⏭️  @user2 (user_manually_skipped)
  ⏭️  @user3 (user_blocked) ← 不接受消息
  ⏭️  @user4 (user_manually_skipped)
  ⏭️  @user5 (user_not_found) ← 用户不存在

════════════════════════════════════════
```

---

## 💡 最佳实践

### 1. 发送前先检查

```
✅ 推荐流程：
1. 浏览器打开用户主页
2. 查看是否有訊息按钮
3. 确认后再输入 y 或 n
4. 避免发送失败
```

### 2. 批量筛选

```
如果您有大量用户：
1. 先手动浏览一遍
2. 记录哪些用户有訊息按钮
3. 只向有按钮的用户发送
```

### 3. 提高成功率

```
✅ 发送给：
- 公开账号 + 有訊息按钮
- 已关注的用户
- 活跃的用户

❌ 避免发送给：
- 没有訊息按钮的用户
- 私密账号（未关注）
- 不活跃的账号
```

---

## 🎉 总结

### ✅ 功能优势

1. ✅ **提前确认**：发送前知道用户是否接受消息
2. ✅ **避免浪费**：不向无法发送的用户尝试
3. ✅ **提高成功率**：只向可以接收消息的用户发送
4. ✅ **自动跳过**：即使误判也会自动检测并跳过

### 🎯 使用建议

- 每个用户发送前都检查浏览器
- 看到【訊息】按钮就输入 `y`
- 没有【訊息】按钮就输入 `n`
- 不确定就输入 `s` 跳过

---

**🚀 立即开始：run.bat**

**💡 记住：有【訊息】按钮 = 可以发送！**

