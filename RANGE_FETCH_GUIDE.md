# 📍 範圍抓取功能使用指南

## 🎯 新功能概述

現在您可以：
1. ✅ **指定範圍抓取**：從第 N 個到第 X 個粉絲
2. ✅ **實時進度顯示**：邊抓邊顯示當前狀態

---

## 🚀 功能 1：指定範圍抓取

### 使用場景

當一個帳號有很多粉絲時，您可能只想抓取其中一部分：

| 場景 | 設置 |
|------|------|
| **分批抓取** | 第 1-1000, 1001-2000, 2001-3000... |
| **只要前面的** | 第 1-500（最新的粉絲） |
| **跳過前面的** | 從第 101 開始（跳過前 100） |
| **只要中間的** | 第 501-1000 |

### 如何使用

#### 1. 打開匯出對話框

點擊「👥 匯出粉絲」按鈕

#### 2. 填寫範圍

```
Instagram 帳號名稱: instagram

📍 抓取範圍（選填）
├─ 從第幾個開始: 101
└─ 到第幾個結束: 500
```

#### 3. 開始抓取

點擊「開始匯出」，系統會：
- 掃描前 500 個粉絲
- 只保存第 101-500 個
- 跳過前 100 個

---

## 📊 範圍設置示例

### 示例 1：抓取前 1000 個

```
開始: (留空)
結束: 1000
```

**效果：** 抓取前 1000 個粉絲

---

### 示例 2：從第 501 個開始到最後

```
開始: 501
結束: (留空)
```

**效果：** 跳過前 500 個，抓取剩下的全部

---

### 示例 3：只抓 1001-2000

```
開始: 1001
結束: 2000
```

**效果：** 只抓取第 1001-2000 個粉絲（共 1000 個）

---

### 示例 4：抓取全部（默認）

```
開始: (留空)
結束: (留空)
```

**效果：** 抓取所有粉絲，無限制

---

## 🔥 功能 2：實時進度顯示

### 進度信息

抓取過程中，會實時顯示：

#### 全部抓取模式

```
正在抓取粉絲... 已獲取 1,234 個
```

#### 範圍抓取模式

```
正在抓取第 101-500 個... 已掃描 432 個，符合條件 332 個
```

**說明：**
- **已掃描**：已經檢查了多少個粉絲
- **符合條件**：在指定範圍內的粉絲數量

---

## 💡 使用技巧

### 1. 分批抓取大帳號

如果要抓取一個有 50,000 粉絲的大帳號：

```bash
# 第一批
開始: 1, 結束: 10000

# 第二批  
開始: 10001, 結束: 20000

# 第三批
開始: 20001, 結束: 30000

# ... 以此類推
```

**優點：**
- 減少單次抓取時間
- 降低被限制風險
- 可以暫停後繼續

---

### 2. 只要最新的粉絲

```bash
開始: (留空)
結束: 500
```

抓取最新的 500 個粉絲（Instagram 按時間排序）

---

### 3. 跳過已經抓過的

假設您上次抓到第 5000 個：

```bash
開始: 5001
結束: (留空)
```

從第 5001 個開始，抓取剩下的全部

---

### 4. 測試用小範圍

在測試時，建議使用小範圍：

```bash
開始: 1
結束: 10
```

只抓 10 個粉絲，快速驗證功能

---

## 📈 性能說明

### 抓取速度

- **每頁**: 50 個粉絲
- **延遲**: 1 秒/頁
- **速度**: 約 3,000 個/分鐘

### 預估時間

| 範圍 | 預估時間 |
|------|---------|
| 1-100 | 2 秒 |
| 1-500 | 10 秒 |
| 101-500 (掃描 500) | 10 秒 |
| 1-1,000 | 20 秒 |
| 1-5,000 | 2 分鐘 |
| 1-10,000 | 4 分鐘 |
| 5001-10,000 (掃描 10,000) | 4 分鐘 |

**注意：** 即使只要部分粉絲，也需要掃描到指定位置

---

## 🎯 API 使用

如果您是開發者，可以直接使用 API：

### JavaScript API

```javascript
const result = await igAPI.fetchFollowers('username', {
    start: 101,    // 從第 101 個開始
    end: 500,      // 到第 500 個結束
    onProgress: (count, total, status) => {
        console.log(`已獲取: ${count}, 已掃描: ${total}`);
        console.log(status);
    }
});

console.log(result);
// {
//   success: true,
//   followers: ['user101', 'user102', ...],  // 400 個用戶名
//   count: 400,                              // 符合條件的數量
//   totalScanned: 500,                       // 總共掃描的數量
//   range: { start: 101, end: 500 }
// }
```

### 參數說明

| 參數 | 類型 | 默認 | 說明 |
|------|------|------|------|
| `start` | number | 1 | 從第幾個開始（包含） |
| `end` | number | 0 | 到第幾個結束（包含），0=不限制 |
| `maxCount` | number | 0 | 兼容舊版本，會被 start/end 覆蓋 |
| `onProgress` | function | null | 進度回調函數 |

### 回調函數

```javascript
onProgress(count, total, status)
```

- **count**: 符合條件的粉絲數量
- **total**: 已掃描的總數
- **status**: 狀態文字描述

---

## ⚠️ 注意事項

### 1. 範圍驗證

```javascript
// ❌ 錯誤：開始 > 結束
start: 500, end: 100  // 不允許

// ✅ 正確
start: 100, end: 500
```

### 2. 掃描時間

即使只要 100 個粉絲：

```javascript
start: 901, end: 1000  // 只要 100 個
```

系統仍需要掃描前 1000 個粉絲才能找到這 100 個

### 3. 順序問題

粉絲順序由 Instagram API 決定：
- 通常是**按關注時間**排序
- 最新的粉絲在前面
- 但 Instagram 可能會調整順序

### 4. 私密帳號

- 只能抓取**公開帳號**的粉絲
- 或您已關注的**私密帳號**

---

## 🔧 故障排除

### Q: 為什麼抓取很慢？

**A:** 因為需要掃描到指定位置

```
要抓取第 9001-10000 個粉絲
需要先掃描前 10000 個
預計需要 4 分鐘
```

**解決方案：** 考慮分批抓取，每批 5000-10000 個

---

### Q: 顯示「符合條件 0 個」？

**A:** 可能原因：

1. **範圍設置錯誤**
   ```
   start: 10000, end: 20000
   但該用戶只有 5000 個粉絲
   ```

2. **帳號粉絲數不足**
   ```
   start: 501
   但該用戶只有 500 個粉絲
   ```

**解決方案：** 調整範圍或檢查用戶粉絲數

---

### Q: 實時進度不更新？

**A:** 確認：
1. 匯出對話框仍然開啟
2. 應用沒有崩潰
3. 網路連接正常

---

## 📊 實際案例

### 案例 1：抓取競爭對手的新粉絲

**目標：** 每週抓取一次，只要新增的粉絲

```
第一週: start=1, end=5000
第二週: start=1, end=5000  (會包含新增的)
```

**或者：**

```
第一週: start=1, end=(留空)  → 得到 8,234 個
第二週: start=1, end=(留空)  → 得到 8,567 個
比較差異 → 找出 333 個新粉絲
```

---

### 案例 2：避開限制

**問題：** 一次抓取 50,000 個可能被限制

**解決：** 分 5 批進行

```batch
批次 1: start=1,     end=10000
批次 2: start=10001, end=20000
批次 3: start=20001, end=30000
批次 4: start=30001, end=40000
批次 5: start=40001, end=50000
```

每批間隔 5-10 分鐘

---

### 案例 3：只要活躍粉絲

**假設：** 最新的 1000 個粉絲通常更活躍

```
start: (留空)
end: 1000
```

用這 1000 個用戶進行營銷測試

---

## 🎉 總結

### ✅ 您現在可以：

1. **靈活控制抓取範圍**
   - 從第 N 個到第 X 個
   - 只要前面的
   - 跳過前面的

2. **實時查看進度**
   - 已掃描多少
   - 符合條件多少
   - 當前狀態

3. **分批處理大帳號**
   - 避免超時
   - 降低風險
   - 靈活暫停

### 📝 最佳實踐

1. **測試時用小範圍** (1-10)
2. **大帳號分批抓取** (每批 5000-10000)
3. **注意延遲** (批次間隔 5-10 分鐘)
4. **保存進度** (記錄已抓到哪裡)

---

**開始使用這些強大的新功能吧！** 🚀

