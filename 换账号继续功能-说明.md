# 换账号继续功能 - 使用说明

## ✨ 新功能特点

当群发过程中遇到登入问题时，程序会：
1. ⏸️ **自动暂停** - 停止当前发送
2. 💬 **弹出对话框** - 提示重新登入
3. 🔄 **换账号登入** - 可以用其他账号登入
4. ▶️ **继续处理** - 自动跳过失败的用户，继续发送下一个

## 🎯 工作流程

### 情况1：正常发送

```
用户1 → 发送成功 ✅
用户2 → 发送成功 ✅
用户3 → 发送成功 ✅
...
```

### 情况2：遇到登入问题（NEW!）

```
用户1 → 发送成功 ✅
用户2 → 发送成功 ✅
用户3 → ❌ 登入错误！

⬇️ 程序自动暂停

弹出对话框：
┌────────────────────────────────┐
│  ⚠️ 检测到登入问题             │
│                                │
│  错误：Session 已过期或需要验证 │
│  当前用户：@user3              │
│                                │
│  💡 建议操作：                 │
│  1. 点击【重新登入并继续】      │
│  2. 输入新的帐号密码           │
│  3. 登入成功后自动继续         │
│  4. 处理下一个用户             │
│                                │
│  [🔄 重新登入并继续] [🛑 停止] │
└────────────────────────────────┘

⬇️ 你选择【重新登入并继续】

弹出登入提示：
┌────────────────────────────────┐
│  🔐 请重新登入                 │
│                                │
│  请在主画面中：                │
│  1️⃣ 点击【登入】按钮          │
│  2️⃣ 输入帐号密码              │
│  3️⃣ 登入成功后点击【确认完成】│
│                                │
│  [✅ 确认完成] [❌ 取消]       │
└────────────────────────────────┘

⬇️ 你登入新账号并点击【确认完成】

程序验证登入状态 → ✅ 已登入

⬇️ 自动继续

用户3 → 已跳过 ⏭️ (因为之前失败)
用户4 → 发送成功 ✅
用户5 → 发送成功 ✅
...
```

## 📋 使用步骤

### 1. 正常开始群发

```
1. 登入账号A
2. 匯入用户清单
3. 点击【开始群发】
```

### 2. 遇到登入问题时

当看到 **"检测到登入问题"** 对话框：

```
选项1：🔄 重新登入并继续
- 点击此按钮
- 在登入框输入新账号B的账号密码
- 点击【登入】
- 等待登入成功
- 点击对话框中的【确认完成】
- ✅ 程序自动继续发送剩余用户

选项2：🛑 停止群发
- 点击此按钮
- 程序停止，显示统计结果
```

### 3. 继续发送

登入成功后：
- ✅ 自动跳过当前失败的用户
- ✅ 继续处理下一个用户
- ✅ 用新账号B继续发送

## 💡 使用场景

### 场景1：账号被限制

```
用账号A发送了20个用户后被限制
↓
弹出重新登入对话框
↓
切换到账号B继续发送剩余用户
↓
无缝继续！
```

### 场景2：Session 过期

```
发送过程中Session过期
↓
弹出重新登入对话框
↓
重新登入（可以用同一账号或换账号）
↓
继续发送！
```

### 场景3：需要验证

```
Instagram要求验证账号
↓
弹出重新登入对话框
↓
换一个不需要验证的账号
↓
继续发送！
```

## 🎨 对话框详解

### 第一个对话框：登入问题提示

```
⚠️ 检测到登入问题

错误：[具体错误信息]
当前用户：@[失败的用户名]

💡 建议操作：
1. 点击【重新登入并继续】
2. 在登入框中输入新的帐号密码
3. 登入成功后，程序会跳过当前用户
4. 自动继续处理下一个用户

[🔄 重新登入并继续] [🛑 停止群发]
```

**按钮说明：**
- **🔄 重新登入并继续**：暂停并等待你重新登入，然后继续
- **🛑 停止群发**：完全停止，显示统计结果

### 第二个对话框：等待登入

```
🔐 请重新登入

请在主画面中：
1️⃣ 点击【登入】按钮
2️⃣ 输入帐号密码
3️⃣ 登入成功后点击【确认完成】

[✅ 确认完成] [❌ 取消]
```

**按钮说明：**
- **✅ 确认完成**：验证你已经登入成功，然后继续发送
- **❌ 取消**：放弃重新登入，停止群发

## ⚠️ 重要提示

### 1. 跳过失败用户

重新登入后，**当前失败的用户会被跳过**，不会重试。

原因：避免重复发送或再次触发限制。

### 2. 验证登入状态

点击【确认完成】时，程序会验证你是否真的登入成功。

如果尚未登入：
```
❌ 尚未登入成功！

请先完成登入后再点击【确认完成】。
```

### 3. 可以换账号

你可以：
- ✅ 用相同账号重新登入
- ✅ 换一个完全不同的账号
- ✅ 用备用账号继续发送

### 4. 继续点位置

重新登入后，从**下一个用户**开始：

```
假设有 5 个用户：
1. user1 ✅ 成功
2. user2 ✅ 成功
3. user3 ❌ 登入错误 → 触发重新登入
4. user4 ⏳ 等待中
5. user5 ⏳ 等待中

重新登入后：
3. user3 ⏭️ 跳过
4. user4 ✅ 继续发送
5. user5 ✅ 继续发送
```

## 🔧 技术细节

### 错误检测

程序会检测以下错误关键字：
- `登入`
- `Session`
- `验证`

当发送失败且错误消息包含这些关键字时，会触发重新登入流程。

### 登入验证

点击【确认完成】时，程序会：
1. 调用 `check-login-status` API
2. 验证 Session 是否有效
3. 如果有效，继续发送
4. 如果无效，提示重新登入

### 状态保持

重新登入过程中：
- ✅ 已发送的用户状态保持
- ✅ 待发送的用户继续排队
- ✅ 当前失败的用户标记为跳过
- ✅ 统计数据保持准确

## 📊 统计报告

完成后的统计会包括：

```
批量发送完成！

✅ 成功：5 个
⏭️ 跳过：1 个  ← 包括重新登入时跳过的用户
❌ 失败：0 个
```

**跳过**包括：
- 手动选择跳过的用户
- 因重新登入而跳过的用户

## 💡 最佳实践

### 1. 准备备用账号

建议准备 2-3 个账号：
- 账号A：主账号
- 账号B：备用账号1
- 账号C：备用账号2

### 2. 分批发送

建议每批次 < 10 个用户：
- 减少触发限制的概率
- 即使需要换账号，影响也小

### 3. 快速切换

提前记住备用账号的密码：
- 遇到问题时能快速切换
- 减少等待时间

### 4. 监控状态

发送过程中留意：
- 成功率下降 → 可能要被限制了
- 提前准备切换账号

## 🎯 示例场景

### 完整示例

```
开始：用账号A登入
用户1 → ✅ 成功
用户2 → ✅ 成功
用户3 → ❌ Session过期！

[弹出对话框]
你选择：🔄 重新登入并继续

[切换到账号B]
输入账号B的用户名和密码
点击【登入】
等待...登入成功！

[回到对话框]
点击：✅ 确认完成

验证中...
✅ 已验证账号B登入成功

继续发送：
用户3 → ⏭️ 跳过（之前失败的）
用户4 → ✅ 成功（用账号B发送）
用户5 → ✅ 成功（用账号B发送）
...

完成！
✅ 成功：4 个
⏭️ 跳过：1 个
❌ 失败：0 个
```

## 📚 相关文档

- [Maximum-Redirects-錯誤-解決方案.md](Maximum-Redirects-錯誤-解決方案.md) - 重定向错误详解
- [逐個發送-使用說明.md](逐個發送-使用說明.md) - 逐个发送功能说明
- [完整故障排除指南.md](完整故障排除指南.md) - 所有错误的解决方案

## ✨ 总结

新功能让你可以：

1. ✅ **无缝切换** - 遇到问题立即换账号
2. ✅ **不中断流程** - 继续发送剩余用户
3. ✅ **灵活应对** - 随时换账号应对各种情况
4. ✅ **提高效率** - 不用重新开始，节省时间

**让群发更加稳定和高效！** 🎉

---

**更新日期：** 2025-11-01  
**版本：** 1.3.0

